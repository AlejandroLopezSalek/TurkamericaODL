{# Macro para items de actividades del horario #}
{% macro activityItem(timeSlot, title, description, icon) %}
<div class="activity-item flex flex-col sm:flex-row items-center sm:items-center gap-3 sm:gap-4 p-4 sm:p-5 mb-2 rounded-xl
            bg-white dark:bg-slate-700
            border border-slate-200 dark:border-slate-600
            hover:shadow-md hover:border-blue-300 dark:hover:border-blue-500
            hover:translate-x-1 transition-all duration-300 cursor-pointer">
    <div class="time-slot text-sm font-semibold text-blue-600 dark:text-blue-400
                bg-blue-50 dark:bg-blue-900/30 px-3 py-1.5 rounded-full
                w-full sm:w-auto min-w-[120px] text-center flex-shrink-0">{{ timeSlot }}</div>
    <div class="activity-content flex-1 w-full text-center sm:text-left min-w-0">
        <h4 class="text-base font-semibold text-slate-800 dark:text-slate-100 mb-1">{{ title }}</h4>
        <p class="text-sm text-slate-600 dark:text-slate-400">{{ description }}</p>
    </div>
    <div class="activity-icon w-10 h-10 bg-blue-600 text-white rounded-full
                flex items-center justify-center flex-shrink-0
                hover:scale-110 transition-transform duration-300 hidden sm:flex">
        <i class="fas fa-{{ icon }}"></i>
    </div>
</div>
{% endmacro %}

{# Macro para items de canales de YouTube #}
{% macro channelItem(url, name) %}
<li class="flex items-center gap-3 px-4 py-2.5
           bg-white dark:bg-slate-700
           border border-slate-200 dark:border-slate-600
           rounded-lg
           hover:bg-red-600 hover:text-white hover:border-red-600
           transition-all duration-300 group">
    <i class="fab fa-youtube text-red-600 group-hover:text-white transition-colors"></i>
    <a href="{{ url }}" target="_blank" 
       class="text-sm font-medium text-slate-700 dark:text-slate-300 group-hover:text-white no-underline flex-1 min-w-0 break-words">{{ name }}</a>
</li>
{% endmacro %}

{# Macro para links de recursos (gramática, diccionarios, etc) #}
{% macro resourceLink(url, name) %}
<li>
    <a href="{{ url }}" target="_blank" class="flex items-center gap-3 px-4 py-3
              bg-white dark:bg-slate-700
              border border-slate-200 dark:border-slate-600
              rounded-lg
              text-slate-700 dark:text-slate-300
              font-medium
              hover:bg-purple-600 hover:text-white hover:border-purple-600
              dark:hover:bg-blue-600 dark:hover:border-blue-600
              hover:shadow-lg hover:shadow-blue-500/20
              transition-all duration-300
              no-underline">
        <i class="fas fa-external-link-alt text-sm opacity-70"></i>
        {{ name }}
    </a>
</li>
{% endmacro %}

{# Macro para item de preferencia con toggle switch #}
{% macro preferenceItem(icon, title, subtitle, id, checked=false) %}
<div class="flex items-center justify-between p-6 bg-slate-50 dark:bg-slate-700/50 rounded-xl hover:shadow-md transition-shadow duration-300 border border-slate-200 dark:border-slate-600">
    <div class="flex items-center gap-4">
        <i class="fas fa-{{ icon }} text-xl text-indigo-600 dark:text-indigo-400 w-8 text-center"></i>
        <div>
            <h4 class="font-semibold text-slate-800 dark:text-slate-100">{{ title }}</h4>
            <p class="text-sm text-slate-500 dark:text-slate-400">{{ subtitle }}</p>
        </div>
    </div>
    <label class="toggle-switch relative inline-block w-12 h-6">
        <input type="checkbox" id="{{ id }}" {% if checked %}checked{% endif %} class="opacity-0 w-0 h-0 peer">
        <span class="slider round absolute cursor-pointer inset-0 bg-slate-300 dark:bg-slate-600 transition-all duration-300 rounded-full before:absolute before:content-[''] before:h-4 before:w-4 before:left-1 before:bottom-1 before:bg-white before:transition-all before:duration-300 before:rounded-full peer-checked:bg-indigo-600 peer-checked:before:translate-x-6"></span>
    </label>
</div>
{% endmacro %}

{# Macro para item de preferencia con select #}
{% macro preferenceSelect(icon, title, subtitle, id, options) %}
<div class="flex items-center justify-between p-6 bg-slate-50 dark:bg-slate-700/50 rounded-xl hover:shadow-md transition-shadow duration-300 border border-slate-200 dark:border-slate-600">
    <div class="flex items-center gap-4">
        <i class="fas fa-{{ icon }} text-xl text-indigo-600 dark:text-indigo-400 w-8 text-center"></i>
        <div>
            <h4 class="font-semibold text-slate-800 dark:text-slate-100">{{ title }}</h4>
            <p class="text-sm text-slate-500 dark:text-slate-400">{{ subtitle }}</p>
        </div>
    </div>
    <select id="{{ id }}" class="bg-white dark:bg-slate-800 border border-slate-300 dark:border-slate-600 rounded-lg py-2 px-3 text-sm focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 dark:text-slate-200">
        {% for opt in options %}
        <option value="{{ opt.value }}" {% if opt.selected %}selected{% endif %}>{{ opt.label }}</option>
        {% endfor %}
    </select>
</div>
{% endmacro %}

{# Macro para item de preferencia con input #}
{% macro preferenceInput(icon, title, subtitle, id, type="text", value="", min="", max="") %}
<div class="flex items-center justify-between p-6 bg-slate-50 dark:bg-slate-700/50 rounded-xl hover:shadow-md transition-shadow duration-300 border border-slate-200 dark:border-slate-600">
    <div class="flex items-center gap-4">
        <i class="fas fa-{{ icon }} text-xl text-indigo-600 dark:text-indigo-400 w-8 text-center"></i>
        <div>
            <h4 class="font-semibold text-slate-800 dark:text-slate-100">{{ title }}</h4>
            <p class="text-sm text-slate-500 dark:text-slate-400">{{ subtitle }}</p>
        </div>
    </div>
    <input type="{{ type }}" id="{{ id }}" value="{{ value }}" min="{{ min }}" max="{{ max }}"
           class="w-20 text-center bg-white dark:bg-slate-800 border border-slate-300 dark:border-slate-600 rounded-lg py-2 px-3 text-sm focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 dark:text-slate-200">
</div>
{% endmacro %}

{# Macro for Grammar Cards (A1-C1) #}
{% macro grammarCard(title, level, description, topic) %}
<div class="grammar-card bg-white dark:bg-slate-800 rounded-2xl p-6 shadow-lg border border-slate-100 dark:border-slate-700 hover:-translate-y-1 transition-all duration-300 h-full flex flex-col">
    <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-4 gap-2">
        <h3 class="text-xl font-bold text-slate-800 dark:text-slate-100">{{ title }}</h3>
        <span class="px-3 py-1 text-xs font-semibold rounded-full 
            {% if level == 'Básico' %} bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400
            {% elif level == 'Intermedio' %} bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400
            {% elif level == 'Avanzado' %} bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400
            {% else %} bg-slate-100 text-slate-700 dark:bg-slate-700 dark:text-slate-300 {% endif %}">
            {{ level }}
        </span>
    </div>
    <p class="card-description text-slate-600 dark:text-slate-400 mb-6 leading-relaxed flex-grow">
        {{ description }}
    </p>
    <button class="explanation-btn w-full sm:w-auto px-6 py-2.5 bg-indigo-600 hover:bg-indigo-700 text-white font-semibold rounded-xl flex items-center justify-center gap-2 transition-colors duration-300 mt-auto" 
            data-topic="{{ topic }}">
        <i class="fas fa-play text-sm"></i>
        <span>Ver Explicación</span>
    </button>
</div>
{% endmacro %}

{# Macro for Level Filter Tabs #}
{% macro levelFilterTab(level, label) %}
<button
    class="filter-tab min-w-[7rem] h-16 px-6 rounded-xl font-bold text-lg flex items-center justify-center transition-all shadow-sm border border-transparent
           bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-300
           hover:bg-blue-100 hover:text-blue-600 hover:border-blue-200 hover:scale-105
           dark:hover:bg-blue-900/30 dark:hover:text-blue-400
           [&.active]:bg-gradient-to-r [&.active]:from-blue-600 [&.active]:to-blue-700 [&.active]:text-white [&.active]:shadow-lg [&.active]:scale-110 [&.active]:border-transparent"
    data-level="{{ level }}">
    {{ label }}
</button>
{% endmacro %}

{# Macro for Affiliate/Recommendation Cards #}
{% macro affiliateCard(title, description, link, btnText="Empezar Ahora", badge="", icon="star", footer="") %}
<div class="affiliate-card relative overflow-hidden bg-white dark:bg-slate-800 rounded-2xl p-6 shadow-lg border border-slate-100 dark:border-slate-700 hover:-translate-y-1 transition-all duration-300 flex flex-col h-full group">
    {% if badge %}
    <div class="absolute top-0 right-0 bg-yellow-400 text-yellow-900 text-xs font-bold px-3 py-1 rounded-bl-xl z-10 shadow-sm">
        {{ badge }}
    </div>
    {% endif %}

    <div class="flex items-center gap-4 mb-4">
        <div class="w-12 h-12 rounded-lg bg-indigo-50 dark:bg-indigo-900/30 flex items-center justify-center text-indigo-600 dark:text-indigo-400">
            <i class="fas fa-{{ icon }} text-xl"></i>
        </div>
        <div>
            <h3 class="text-lg font-bold text-slate-800 dark:text-slate-100 leading-tight">{{ title }}</h3>
            <div class="flex text-yellow-400 text-xs mt-1 space-x-0.5">
                <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star-half-alt"></i>
            </div>
        </div>
    </div>

    <p class="text-slate-600 dark:text-slate-400 text-sm mb-6 flex-grow leading-relaxed">
        {{ description | safe }}
    </p>

    <a href="{{ link }}" target="_blank" rel="noopener noreferrer" 
       class="w-full py-3 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white font-semibold rounded-xl text-center shadow-md shadow-blue-500/20 hover:shadow-lg hover:shadow-blue-500/30 transition-all duration-300 flex items-center justify-center gap-2 group-hover:scale-[1.02]">
        <span>{{ btnText }}</span>
        <i class="fas fa-arrow-right text-xs transition-transform group-hover:translate-x-1"></i>
    </a>
    
    {% if footer %}
    <p class="text-[10px] text-slate-400 dark:text-slate-500 mt-3 text-center uppercase tracking-wide">
        {{ footer }}
    </p>
    {% endif %}
</div>
{% endmacro %}
